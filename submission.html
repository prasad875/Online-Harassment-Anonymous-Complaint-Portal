<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Submit Complaint | She-Box Portal</title>
  <meta name="description"
    content="Submit your complaint anonymously and securely through our online harassment reporting system.">

  <link rel="stylesheet" href="css/submission.css">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <script src="js/submission.js" defer></script>
</head>

<body>

  <!-- Background Shapes -->
  <div class="bg-shapes">
    <div class="shape shape-1"></div>
    <div class="shape shape-2"></div>
    <div class="shape shape-3"></div>
  </div>

  <!-- MAIN CONTENT -->
  <main class="main-container no-nav">

    <!-- Back to Home Link -->
    <a href="index.html" class="back-home">
      <i class="fa-solid fa-arrow-left"></i>
      Back to Home
    </a>

    <!-- Left Side Info -->
    <aside class="info-panel">
      <div class="info-content">
        <div class="info-icon">
          <i class="fa-solid fa-file-shield"></i>
        </div>
        <h2>Submit Your Complaint</h2>
        <p>Your information is protected with end-to-end encryption. Report incidents safely and anonymously.</p>

        <div class="info-features">
          <div class="info-feature">
            <div class="feature-icon">
              <i class="fa-solid fa-lock"></i>
            </div>
            <div>
              <h4>256-bit Encryption</h4>
              <p>Your data is fully protected</p>
            </div>
          </div>

          <div class="info-feature">
            <div class="feature-icon">
              <i class="fa-solid fa-user-secret"></i>
            </div>
            <div>
              <h4>100% Anonymous</h4>
              <p>Identity is always hidden</p>
            </div>
          </div>

          <div class="info-feature">
            <div class="feature-icon">
              <i class="fa-solid fa-clock"></i>
            </div>
            <div>
              <h4>Quick Response</h4>
              <p>Within 48 hours</p>
            </div>
          </div>
        </div>

        <div class="help-box">
          <i class="fa-solid fa-circle-question"></i>
          <div>
            <h4>Need Help?</h4>
            <p>Contact our 24/7 helpline at <strong>1800-XXX-XXXX</strong></p>
          </div>
        </div>
      </div>
    </aside>

    <!-- Form Container -->
    <div class="form-wrapper">
      <div class="form-container">
        <div class="form-header">
          <h2>Complaint Registration Form</h2>
          <p>Fill in the details below to submit your complaint</p>
        </div>

        <form id="complaintForm">
          <!-- Progress Steps -->
          <div class="form-progress">
            <div class="progress-step active" data-step="1">
              <div class="step-circle">1</div>
              <span>Incident</span>
            </div>
            <div class="progress-line"></div>
            <div class="progress-step" data-step="2">
              <div class="step-circle">2</div>
              <span>Evidence</span>
            </div>
            <div class="progress-line"></div>
            <div class="progress-step" data-step="3">
              <div class="step-circle">3</div>
              <span>Contact</span>
            </div>
          </div>

          <!-- Step 1: Incident Info -->
          <div class="form-step active" id="step1">
            <div class="form-group">
              <label for="category">
                <i class="fa-solid fa-tag"></i>
                Complaint Category <span class="required">*</span>
              </label>
              <div class="select-wrapper">
                <select id="category" required>
                  <option value="">Select a category</option>
                  <option value="Workplace Harassment">Workplace Harassment</option>
                  <option value="Cyber Bullying">Cyber Bullying</option>
                  <option value="Online Stalking">Online Stalking</option>
                  <option value="Image Abuse">Image Abuse</option>
                  <option value="Identity Theft">Identity Theft</option>
                  <option value="Defamation">Defamation</option>
                  <option value="Public Safety">Public Safety</option>
                  <option value="Cyber Crime">Cyber Crime</option>
                  <option value="Other">Other</option>
                </select>
                <i class="fa-solid fa-chevron-down select-arrow"></i>
              </div>
            </div>

            <div class="form-group">
              <label for="description">
                <i class="fa-solid fa-align-left"></i>
                Description of Incident <span class="required">*</span>
              </label>
              <textarea id="description"
                placeholder="Please describe the incident in detail. Include what happened, when it started, and any relevant context..."
                required></textarea>
              <div class="char-counter"><span id="charCount">0</span>/2000 characters</div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="incidentDate">
                  <i class="fa-solid fa-calendar"></i>
                  Incident Date <span class="required">*</span>
                </label>
                <input type="date" id="incidentDate" required>
              </div>

              <div class="form-group">
                <label for="location">
                  <i class="fa-solid fa-location-dot"></i>
                  Incident Location <span class="required">*</span>
                </label>
                <input type="text" id="location" placeholder="City, State or Online Platform" required>
              </div>
            </div>

            <div class="form-navigation">
              <button type="button" class="btn btn-next" onclick="nextStep(1)">
                Continue <i class="fa-solid fa-arrow-right"></i>
              </button>
            </div>
          </div>

          <!-- Step 2: Evidence Upload -->
          <div class="form-step" id="step2">

            <!-- Evidence Upload Section - Now More Prominent -->
            <div class="upload-section">
              <div class="upload-header">
                <div class="upload-icon">
                  <i class="fa-solid fa-cloud-arrow-up"></i>
                </div>
                <h3>Upload Evidence</h3>
                <p>Add photos, screenshots, documents or any other evidence to support your complaint</p>
              </div>

              <div class="file-upload-area" id="fileUploadArea">
                <input type="file" id="file" multiple accept=".jpg,.jpeg,.png,.gif,.pdf,.doc,.docx,.mp4,.mp3,.webp">
                <div class="upload-content">
                  <div class="upload-icon-large">
                    <i class="fa-solid fa-folder-plus"></i>
                  </div>
                  <h4>Drag & Drop Files Here</h4>
                  <p>or click to browse from your device</p>
                  <div class="file-types">
                    <span><i class="fa-solid fa-image"></i> Images</span>
                    <span><i class="fa-solid fa-file-pdf"></i> PDF</span>
                    <span><i class="fa-solid fa-file-word"></i> DOC</span>
                    <span><i class="fa-solid fa-video"></i> Video</span>
                    <span><i class="fa-solid fa-music"></i> Audio</span>
                  </div>
                  <small>Maximum file size: 25MB per file</small>
                </div>
              </div>

              <!-- Uploaded Files List -->
              <div class="uploaded-files" id="uploadedFiles" style="display: none;">
                <h4><i class="fa-solid fa-paperclip"></i> Uploaded Files</h4>
                <div class="file-list" id="fileList"></div>
              </div>
            </div>

            <div class="form-group">
              <label for="platform">
                <i class="fa-solid fa-globe"></i>
                Platform/Website (if applicable)
              </label>
              <input type="text" id="platform" placeholder="e.g., Facebook, Instagram, Twitter, WhatsApp, etc.">
            </div>

            <div class="form-group">
              <label for="accusedInfo">
                <i class="fa-solid fa-user-slash"></i>
                Accused Information (if known)
              </label>
              <textarea id="accusedInfo"
                placeholder="Any information about the accused - name, username, profile link, phone number, etc. (Optional)"></textarea>
            </div>

            <div class="form-navigation">
              <button type="button" class="btn btn-secondary" onclick="prevStep(2)">
                <i class="fa-solid fa-arrow-left"></i> Back
              </button>
              <button type="button" class="btn btn-next" onclick="nextStep(2)">
                Continue <i class="fa-solid fa-arrow-right"></i>
              </button>
            </div>
          </div>

          <!-- Step 3: Contact Info -->
          <div class="form-step" id="step3">
            <div class="anonymous-notice">
              <i class="fa-solid fa-user-secret"></i>
              <div>
                <h4>Optional Contact Information</h4>
                <p>You can remain completely anonymous. However, providing contact details helps us reach you for
                  updates.</p>
              </div>
            </div>

            <div class="form-group">
              <label for="name">
                <i class="fa-solid fa-user"></i>
                Your Name (Optional)
              </label>
              <input type="text" id="name" placeholder="Enter your full name">
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="email">
                  <i class="fa-solid fa-envelope"></i>
                  Email Address (Optional)
                </label>
                <input type="email" id="email" placeholder="your.email@example.com">
              </div>

              <div class="form-group">
                <label for="phone">
                  <i class="fa-solid fa-phone"></i>
                  Phone Number (Optional)
                </label>
                <input type="tel" id="phone" placeholder="+91 XXXXX XXXXX">
              </div>
            </div>

            <div class="consent-box">
              <label class="checkbox-wrapper">
                <input type="checkbox" id="consent" required>
                <span class="checkmark"></span>
                <span class="checkbox-text">I confirm that the information provided is true to the best of my knowledge
                  and I consent to the processing of this complaint. <span class="required">*</span></span>
              </label>
            </div>

            <div class="form-navigation">
              <button type="button" class="btn btn-secondary" onclick="prevStep(3)">
                <i class="fa-solid fa-arrow-left"></i> Back
              </button>
              <button type="submit" class="btn btn-submit">
                <i class="fa-solid fa-paper-plane"></i> Submit Complaint
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </main>

  <!-- Success Modal -->
  <div class="modal" id="successModal">
    <div class="modal-content">
      <div class="modal-icon success">
        <i class="fa-solid fa-circle-check"></i>
      </div>
      <h2>Complaint Submitted Successfully!</h2>
      <p>Your complaint has been registered. Please save your tracking ID:</p>
      <div class="tracking-id-box">
        <span id="trackingId">XXXXXX</span>
        <button onclick="copyTrackingId()" class="copy-btn">
          <i class="fa-solid fa-copy"></i>
        </button>
      </div>
      <p class="modal-note">Use this ID to track your complaint status</p>
      <div class="modal-buttons">
        <a href="track.html" class="btn btn-primary">Track Complaint</a>
        <a href="index.html" class="btn btn-secondary">Back to Home</a>
      </div>
    </div>
  </div>

  <script>
    // Form step navigation
    let currentStep = 1;

    function nextStep(step) {
      const currentStepElement = document.getElementById(`step${step}`);
      const requiredFields = currentStepElement.querySelectorAll('[required]');
      let isValid = true;

      requiredFields.forEach(field => {
        if (!field.value) {
          field.classList.add('error');
          isValid = false;
        } else {
          field.classList.remove('error');
        }
      });

      if (!isValid) return;

      currentStep = step + 1;
      updateSteps();
    }

    function prevStep(step) {
      currentStep = step - 1;
      updateSteps();
    }

    function updateSteps() {
      document.querySelectorAll('.form-step').forEach((el, index) => {
        el.classList.toggle('active', index + 1 === currentStep);
      });

      document.querySelectorAll('.progress-step').forEach((el, index) => {
        el.classList.toggle('active', index + 1 <= currentStep);
        el.classList.toggle('completed', index + 1 < currentStep);
      });
    }

    // Character counter
    const description = document.getElementById('description');
    const charCount = document.getElementById('charCount');

    description?.addEventListener('input', () => {
      charCount.textContent = description.value.length;
    });

    // Enhanced File upload handling
    const fileInput = document.getElementById('file');
    const fileList = document.getElementById('fileList');
    const fileUploadArea = document.getElementById('fileUploadArea');
    const uploadedFilesSection = document.getElementById('uploadedFiles');
    let uploadedFiles = [];

    fileInput?.addEventListener('change', () => {
      handleFiles(fileInput.files);
    });

    fileUploadArea?.addEventListener('dragover', (e) => {
      e.preventDefault();
      fileUploadArea.classList.add('dragover');
    });

    fileUploadArea?.addEventListener('dragleave', () => {
      fileUploadArea.classList.remove('dragover');
    });

    fileUploadArea?.addEventListener('drop', (e) => {
      e.preventDefault();
      fileUploadArea.classList.remove('dragover');
      handleFiles(e.dataTransfer.files);
    });

    function handleFiles(files) {
      Array.from(files).forEach(file => {
        // Check file size (25MB max)
        if (file.size > 25 * 1024 * 1024) {
          alert(`File "${file.name}" is too large. Maximum size is 25MB.`);
          return;
        }
        uploadedFiles.push(file);
      });
      updateFileList();
    }

    function updateFileList() {
      if (uploadedFiles.length === 0) {
        uploadedFilesSection.style.display = 'none';
        return;
      }

      uploadedFilesSection.style.display = 'block';
      fileList.innerHTML = '';

      uploadedFiles.forEach((file, index) => {
        const fileItem = document.createElement('div');
        fileItem.className = 'file-item';

        const icon = getFileIcon(file.type);
        const size = formatFileSize(file.size);

        fileItem.innerHTML = `
          <div class="file-info">
            <i class="${icon}"></i>
            <div class="file-details">
              <span class="file-name">${file.name}</span>
              <span class="file-size">${size}</span>
            </div>
          </div>
          <button type="button" class="remove-file" onclick="removeFile(${index})">
            <i class="fa-solid fa-xmark"></i>
          </button>
        `;
        fileList.appendChild(fileItem);
      });
    }

    function getFileIcon(type) {
      if (type.startsWith('image/')) return 'fa-solid fa-image';
      if (type.startsWith('video/')) return 'fa-solid fa-video';
      if (type.startsWith('audio/')) return 'fa-solid fa-music';
      if (type.includes('pdf')) return 'fa-solid fa-file-pdf';
      if (type.includes('word') || type.includes('document')) return 'fa-solid fa-file-word';
      return 'fa-solid fa-file';
    }

    function formatFileSize(bytes) {
      if (bytes < 1024) return bytes + ' B';
      if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
      return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
    }

    function removeFile(index) {
      uploadedFiles.splice(index, 1);
      updateFileList();
    }

    // Copy tracking ID
    function copyTrackingId() {
      const trackingId = document.getElementById('trackingId').textContent;
      navigator.clipboard.writeText(trackingId);
      alert('Tracking ID copied to clipboard!');
    }
  </script>

</body>

</html>